window.lpTag=window.lpTag||{},lpTag.taglets=lpTag.taglets||{},lpTag.taglets.lightbox=function(){var n="",e={backgroundColor:"#000000",backgroundImage:"",opacity:0,filter:"alpha(opacity=0)",position:"fixed",top:0,left:0,bottom:0,right:0,zIndex:107108};return{_V:"1.3",name:"lightbox",init:function(){},show:function(){var t;(t=lpTag.taglets.lpJsonToDom.convert({containers:{css:e}})[0]).className=t.className+" LPMlightbox",lpTag.taglets.utils.appendToPage(t),n=t.id,t=lpTag.taglets.utils.geObjById(n),lpTag.taglets.lpAnimate.animate(t,{name:"opacity",targetVal:.7},{easing:"easeOutQuart",duration:1e3})},remove:function(){var t,e;t=function(){var e=lpTag.taglets.utils.geObjById(n);if(void 0!==e&&null!=e)try{e.parentNode.removeChild(e)}catch(t){e.style.display="none"}},e=lpTag.taglets.utils.geObjById(n),lpTag.taglets.lpAnimate.animate(e,{name:"opacity",targetVal:0},{easing:"easeOutQuart",duration:1e3,callback:t})}}},window.lpTag=window.lpTag||{},lpTag.taglets=lpTag.taglets||{},(()=>{function s(t,e){this.start(t,e)}function n(){var t=s,e="prototype",r=lpTag.taglets.utils,n=1,i=0;function a(){this.mainContainer.innerHTML=this.activeState.html;for(var t=this.mainContainer.querySelectorAll('[data-LP-event="click"]'),e=this.mainContainer.querySelectorAll('[data-LP-event="close"]'),n=0;n<t.length;n++)this.setEngagementClickEvent(t[n],this.offerClick,this);if(5!==this.engData.engagementType)for(n=0;n<e.length;n++)this.setCloseEvents(e[n]);this.showOffer()}function o(t,e){for(var n,i=[];(n=t.exec(e))&&n[1]&&0<n[1].length&&i.push(n[1]),null!==n;);return i}void 0!==lpTag.taglets.baseUIOffer&&!0!==t[e].extended&&(t[e]=lpTag.taglets.baseUIOffer.createInstance(),t[e].extended=!0,(t[e].constructor=t)[e].start=function(t,e){this.init(t,e),this.setParentContainer(),this.setConfig(e),this.run()},t[e].setParentContainer=function(){this.debugLog("in setParentContainer.."),this.parentContainer=null,-1!==this.engData.zoneId&&(lpTag.taglets.scraper?this.parentContainer=lpTag.taglets.scraper.getElmId(this.engData.zoneId)||null:this.parentContainer=document.getElementById(this.engData.zoneId))},t[e].setConfig=function(t){this.setEngagementConf(t),this.conf.useLightBox=t.effects&&t.effects.useLightBox},t[e].closeOffer=function(t){var e;this.offerClose(),"keyup"===t.type&&0<(e=document.querySelectorAll("a[href]:not([tabindex='-1']),area[href]:not([tabindex='-1']),input:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']),textarea:not([disabled]):not([tabindex='-1']),button:not([disabled]):not([tabindex='-1']),iframe:not([tabindex='-1']),[tabindex]:not([tabindex='-1']),[contentEditable=true]:not([tabindex='-1'])")).length&&e[0].focus(),r.stopEventBubble(t.htmlEvent)},t[e].createOffer=function(){this.debugLog("in createOffer..");var t=this.getOfferContainer();if(t&&(null!==t.parentDom||5!==this.engData.engagementType)){this.appendToPage(this.setupOffer,t.containerDom,t.parentDom),5!==this.engData.engagementType&&6!==this.engData.engagementType&&(e=t.containerDom,document.body.prepend(e));var e=this.engData&&this.engData.engagementId?this.engData.engagementId:"",n=this.engData.engagementType,i=t.containerDom.querySelectorAll(".LPMlabel")[0];if(i){var a=i;if(4===lpTag.device.os()){var o=getComputedStyle(a).getPropertyValue("font-family"),r=getComputedStyle(a).left,i="bold"===a.style.fontWeight||500<a.style.fontWeight,s=a.style.transform;if(i&&s){0<=o.indexOf("Verdana")&&(a.style.left=parseInt(r,10)+8+"px"),(0<=o.indexOf("Arial Black")||0<=o.indexOf("Impact"))&&(a.style.left=parseInt(r,10)+6+"px");for(var l=["Comic Sans MS","Tahoma","Georgia","Courier New","Symbol","MS Sans Serif","Lucida Sans Unicode","Arial"],g=0;g<l.length;g++)0<=o.indexOf(l[g])&&(a.style.left=parseInt(r,10)+4+"px")}}}var f=t.containerDom,h=this;lpTag.lastClosedEngagementID===e&&setTimeout(function(){f&&(1===n||5===n&&1===h.conf.renderingType?f.firstChild:f).focus(),lpTag.lastClosedEngagementID=null},200)}},t[e].setupOffer=function(t){this.containerId=t,this.mainContainer=this.getObj(this.containerId),1===this.conf.renderingType?this.buildHtmlOverlay(this.mainContainer):(this.buildJsonOverlay(this.mainContainer),this.showOffer())},t[e].getOfferContainer=function(){this.debugLog("in getOfferContainer..");var t={},e=this.getContainerDom();return void 0===e?(this.errorLog("Error creating offer container"),t=null):(t.parentDom=this.parentContainer?document.getElementById(this.parentContainer):null,t.containerDom=e),t},t[e].getContainerDom=function(){var t={css:this.getContainerCss()};return t.engagementType="LPM"+this.getEngagementTypeName(this.conf.type),t.isClickable=!0,this.convertJsonToDom({containers:t})[0]},t[e].getContainerCss=function(){this.debugLog("in getContainerConf..");var t,e,n,i,a,o=this.extractCssProps(this.activeState,["background","border","margin"]);return o.display="none",o&&o.marginTop||o&&o.marginBottom||o&&o.marginLeft||o&&o.marginRight||(o.margin="1px"),null!==this.parentContainer?(o.position="relative",o.top=0,o.left=0):(o.zIndex=this.conf.zIndex,t=o,e=this.conf.position,n=this.location,i=t&&t.marginTop,a=t&&t.marginLeft,i={top:{top:0,bottom:"auto",marginTop:i?t.marginTop:"auto"},middle:{top:"50%",bottom:"auto",marginTop:i?t.marginTop:0},bottom:{top:"auto",bottom:0,marginTop:i?t.marginTop:"auto"},custom:{top:parseInt(e.top,10),bottom:"auto",marginTop:i?t.marginTop:"auto"}},e={left:{left:0,right:"auto",marginLeft:a?t.marginLeft:"auto"},center:{left:"50%",right:"auto",marginLeft:a?t.marginLeft:0},right:{left:"auto",right:0,marginLeft:a?t.marginLeft:"auto"},custom:{left:parseInt(e.left,10),right:"auto",marginLeft:a?t.marginLeft:"auto"}},t.position="fixed",r.extendObj(t,i[n.vertical]),r.extendObj(t,e[n.horizontal])),o},t[e].buildHtmlOverlay=function(){this.debugLog("in buildCustomOffer.."),this.preloadImages((t=>{var e,n=/^["|']|["|']$/g;e=o(/(?:img[^>]+src=["|'])([^["|']+)(?:["|'])/gim,t),Array.prototype.push.apply(e,o(/(?:background-image:[^)]url\()([^\)]+)(?:\))/gim,t));for(var i=0;i<e.length;i++)e[i]=e[i].replace(n,"");return e})(this.activeState.html),a,this.onError)},t[e].addA11yAttr=function(){var t=this.mainContainer.querySelector('[role="button"]');if(t)for(var e=t.querySelectorAll(".LPMlabel"),n=1,i=0;i<e.length;i++)e[i].setAttribute("role","heading"),e[i].setAttribute("aria-level",n++)},t[e].enhanceOverlayAccesibility=function(t,e){var n="";e&&e.labels&&e.labels.length?n=e.labels[0].text:e&&e.images&&e.images.length&&(n=e.images[0].alt),t.setAttribute("aria-label",n),this.isOfferNonConversational()&&(t.setAttribute("role","dialog"),t.setAttribute("aria-modal","true"))},t[e].captureTabFocusOnBlurEvent=function(t){var e=this.mainContainer.querySelectorAll("a[href]:not([tabindex='-1']),area[href]:not([tabindex='-1']),input:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']),textarea:not([disabled]):not([tabindex='-1']),button:not([disabled]):not([tabindex='-1']),iframe:not([tabindex='-1']),[tabindex]:not([tabindex='-1']),[contentEditable=true]:not([tabindex='-1'])");if(null!=t){var n=t.relatedTarget,i=(null==n&&0,null!=n&&null==n.parentNode&&0,!0);if(null!=n&&null!=n.parentNode)for(;null!==n;)n==this.mainContainer&&(i=!1),n=n.parentNode;i&&0,i&&(e[e.length-1]==t.target?e[0]:e[e.length-1]).focus()}},t[e].addA11y=function(){var t=this.mainContainer.querySelector(".LPMcloseButton");t&&(t.setAttribute("aria-label",t.alt),t.setAttribute("tabindex","1"))},t[e].buildJsonOverlay=function(){this.debugLog("in attachEvents.."),this.conf&&this.conf.accessible&&this.mainContainer?(this.createAccessibleContainer(this.mainContainer),this.addElements(this.mainContainer.firstChild,this.activeState.elements),this.repositionCloseBtn(this.mainContainer),this.setEngagementClickEvent(this.mainContainer.firstChild,this.offerClick,this)):(this.addElements(this.mainContainer,this.activeState.elements),this.setEngagementClickEvent(this.mainContainer,this.offerClick,this)),this.enhanceOverlayAccesibility(this.mainContainer,this.activeState.elements)},t[e].showOffer=function(){var t,e,n;this.debugLog("in showOffer.."),this.conf.useLightBox&&(this.lightbox=new lpTag.taglets.lightbox,this.lightbox.show({zIndex:this.conf.zIndex-1})),this.addA11y(),this.addA11yAttr(),this.show(),this.onImpression(),this.setTimeout(this.offerTimeout),this.isOfferNonConversational()&&null!=(t=this.mainContainer.querySelector('[role="button"]'))&&t.focus(),null===this.parentContainer&&(t=this.mainContainer,e=(n=this.location)&&n.horizontal||"",n=n&&n.vertical||"",("0px"===t.style.marginTop||"auto"===t.style.marginTop&&("right"===e&&"middle"===n||"left"===e&&"middle"===n))&&(t.style.marginTop=-parseInt(t.offsetHeight/2,10)+"px"),"0px"===t.style.marginLeft||"auto"===t.style.marginLeft&&("center"===e&&"top"===n||"center"===e&&"bottom"===n))&&(t.style.marginLeft=-parseInt(t.offsetWidth/2,10)+"px")},t[e].cleanupOffer=function(t){this.debugLog("in cleanupOffer.."),r.clearTimeout(this.offerTimeoutId),this.conf.useLightBox&&this.lightbox.remove(),this.remove(t)},t[e].offerClick=function(){this.click(),1===this.engData.engagementType&&this.cleanupOffer()},t[e].offerClose=function(t){(t=t||{}).silent||this.onClose(this.offerId),this.cleanupOffer(t)},t[e].offerTimeout=function(){this.onTimeout(this.offerId),this.cleanupOffer()},t[e].isOfferNonConversational=function(){var t=this.engData&&this.engData.hasOwnProperty("conversationType"),e=t&&this.engData.conversationType;return!t||e!==i&&e!==n})}lpTag.taglets.overlay={v:"0.1",name:"overlay",init:function(){},createInstance:function(t,e){return 1!==e.type&&1!==e.renderingType||(e.accessible=!0),n(),new s(t,e)}}})();